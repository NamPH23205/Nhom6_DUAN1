CREATE DATABASE DUAN1_NHOM6
USE DUAN1_NHOM6
GO
--sản phẩm
CREATE TABLE SANPHAM(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)

--Nhà sản xuất
CREATE TABLE NSX(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
QuocGia NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)

--màu sắc
CREATE TABLE MAUSAC(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)

-- chất liệu đế dày
CREATE TABLE CHATLIEUDEGIAY(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)

-- loại sản phẩm
CREATE TABLE LOAISP(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)


--hãng
CREATE TABLE HANG(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)

--ảnh
CREATE TABLE IMG(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)

-- chi tiết sản phẩm

CREATE TABLE CHITIETSANPHAM(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdSP UNIQUEIDENTIFIER,
IdNSX UNIQUEIDENTIFIER,
IdMS UNIQUEIDENTIFIER,
IdLoaiSP UNIQUEIDENTIFIER,
IdHang UNIQUEIDENTIFIER,
IdCLDG UNIQUEIDENTIFIER,
IdImage UNIQUEIDENTIFIER,
GiaNhap DECIMAL(20,0) DEFAULT 0,
GiaBan DECIMAL(20,0) DEFAULT 0,
SoLuongTon INT,
Size VARCHAR(20) UNIQUE,
MaQR VARCHAR(100) UNIQUE,
MaVoucher VARCHAR(100) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)

-- khuyến mãi

CREATE TABLE KHUYENMAI(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
Giatri DECIMAL(20,0) DEFAULT 0,
LoaiKhuyenMai NVARCHAR(50) DEFAULT NULL,
NgayBatDau DATE  DEFAULT NULL,
NgayKetThuc DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)


--chi tiết khuyến mãi

CREATE TABLE CTKHUYENMAI(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
NgayTao DATE  DEFAULT NULL,
MaSp VARCHAR(20) UNIQUE,
TenSp NVARCHAR(50) DEFAULT NULL,
DonGia DECIMAL(20,0) DEFAULT 0,
DonGiaConLai DECIMAL(20,0) DEFAULT 0,
IdKM UNIQUEIDENTIFIER,
IdCTSP UNIQUEIDENTIFIER,
)

-- hóa đơn

CREATE TABLE CTHOADON(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdHD UNIQUEIDENTIFIER,
IdNHANVIEN UNIQUEIDENTIFIER,
IdKHACHHANG UNIQUEIDENTIFIER,
TrangThai INT DEFAULT 0,
TongTien DECIMAL(20,0) DEFAULT 0,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TienKhachDua DECIMAL(20,0) DEFAULT 0,
TienChuyenKKhoan DECIMAL(20,0) DEFAULT 0,
TienThua DECIMAL(20,0) DEFAULT 0,
TenNguoiNhan NVARCHAR(50) DEFAULT NULL,
SdtNguoiNhan VARCHAR(30) UNIQUE,
SdtNguoiShip VARCHAR(30) UNIQUE,
TienShip DECIMAL(20,0) DEFAULT 0,
LyDo VARCHAR(100) UNIQUE,
HinhThucTT VARCHAR(30) UNIQUE,
HinhThucBH VARCHAR(30) UNIQUE,
DiaChi NVARCHAR(100) DEFAULT NULL,
)


-- hóa đơn chi tiết

CREATE TABLE HOADON(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdCTSP UNIQUEIDENTIFIER,
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
SoLuong INT,
DonGia DECIMAL(20,0) DEFAULT 0,
TongTien DECIMAL(20,0) DEFAULT 0,
)

-- chức vụ

CREATE TABLE CHUCVU(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)

-- nhân viên

CREATE TABLE NHANVIEN(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
IdCV UNIQUEIDENTIFIER,
HoTen NVARCHAR(50) DEFAULT NULL,
GioiTinh INT,
NgaySinh DATE  DEFAULT NULL,
DiaChi NVARCHAR(100) DEFAULT NULL,
Sdt VARCHAR(30) UNIQUE,
Email VARCHAR(50) UNIQUE,
MatKhau VARCHAR(30) UNIQUE,
NgayTao DATE  DEFAULT NULL,
NgaySua DATE  DEFAULT NULL,
TrangThai INT DEFAULT 0,
)

--khách hàng

CREATE TABLE KHACHHANG(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
NgaySinh DATE  DEFAULT NULL,
GioiTinh INT,
Sdt VARCHAR(30) UNIQUE,
DiaChi NVARCHAR(100) DEFAULT NULL,
TrangThai INT DEFAULT 0,
)



GO
--TẠO QUAN HỆ GIỮA CÁC BẢNG
--Chi tiết sản phẩm - sản phẩm
ALTER TABLE CHITIETSANPHAM ADD FOREIGN KEY (IdSP) REFERENCES SANPHAM(Id)
--Chi tiết sản phẩm - chất iệu đế giày
ALTER TABLE CHITIETSANPHAM ADD FOREIGN KEY (IdCLDG) REFERENCES CHATLIEUDEGIAY(Id)
--Chi tiết sản phẩm - NSX
ALTER TABLE CHITIETSANPHAM ADD FOREIGN KEY (IdNSX) REFERENCES NSX(Id)
--Chi tiết sản phẩm - Màu sác
ALTER TABLE CHITIETSANPHAM ADD FOREIGN KEY (IdMS) REFERENCES MauSac(Id)
--Chi tiết sản phẩm - loại SP
ALTER TABLE CHITIETSANPHAM ADD FOREIGN KEY (IdLoaiSP) REFERENCES LOAISP(Id)
--Chi tiết sản phẩm - hãng
ALTER TABLE CHITIETSANPHAM ADD FOREIGN KEY (IdHang) REFERENCES HANG(Id)
--Chi tiết sản phẩm - image
ALTER TABLE CHITIETSANPHAM ADD FOREIGN KEY (IdImage) REFERENCES IMG(Id)


--chi tiết khuyến mãi - chi tiết sản phẩm
ALTER TABLE CTKHUYENMAI ADD FOREIGN KEY (IdCTSP) REFERENCES CHITIETSANPHAM(Id)
--chi tiết khuyến mãi - khuyến mãi
ALTER TABLE CTKHUYENMAI ADD FOREIGN KEY (IdKM) REFERENCES KHUYENMAI(Id)


--hóa đơn - chi tiết sản phẩm
ALTER TABLE HOADON ADD FOREIGN KEY (IdCTSP) REFERENCES CHITIETSANPHAM(Id)

--chi tiết hóa đơn - hóa đơn
ALTER TABLE CTHOADON ADD FOREIGN KEY (IdHD) REFERENCES HOADON(Id)
--chi tiết hóa đơn - khách hàng
ALTER TABLE CTHOADON ADD FOREIGN KEY (IdKHACHHANG) REFERENCES KHACHHANG(Id)
--chi tiết hóa đơn - nhân viên
ALTER TABLE CTHOADON ADD FOREIGN KEY (IdNHANVIEN) REFERENCES NHANVIEN(Id)

--nhân viên - chức vụ
ALTER TABLE NHANVIEN ADD FOREIGN KEY (IdCV) REFERENCES CHUCVU(Id)


















